<!DOCTYPE html>
<html ng-app="financeApp">
<head>
  <title>Personal Finance Tracker</title>
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.8.2/angular.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.8.2/angular-route.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
    }
    nav {
      margin-bottom: 20px;
    }
    nav a {
      margin-right: 15px;
      text-decoration: none;
      color: blue;
    }
    nav a.active {
      font-weight: bold;
      color: darkblue;
    }
    section {
      margin-top: 20px;
    }
    ul {
      list-style: none;
      padding: 0;
    }
    li {
      margin: 5px 0;
    }
    form {
      margin-bottom: 20px;
    }
  </style>
</head>
<body>
  <h1>Personal Finance Tracker</h1>

  <nav>
    <a href="#/dashboard" ng-class="{active: currentRoute === '/dashboard'}">Dashboard</a>
    <a href="#/expenses" ng-class="{active: currentRoute === '/expenses'}">Expenses</a>
    <a href="#/income" ng-class="{active: currentRoute === '/income'}">Income</a>
  </nav>

  <div ng-view></div>

  <script>
    const app = angular.module("financeApp", ["ngRoute"]);

    app.config(function ($routeProvider) {
      $routeProvider
        .when("/dashboard", {
          template: `
            <section>
              <h2>Dashboard</h2>
              <p>Total Income: {{summary.totalIncome | currency}}</p>
              <p>Total Expenses: {{summary.totalExpenses | currency}}</p>
              <p>Net Balance: {{summary.netBalance | currency}}</p>
            </section>
          `,
          controller: "DashboardController",
        })
        .when("/expenses", {
          template: `
            <section>
              <h2>Expenses</h2>
              <form ng-submit="addExpense()">
                <input type="number" ng-model="expense.amount" placeholder="Amount" required />
                <input type="text" ng-model="expense.description" placeholder="Description" required />
                <button type="submit">Add Expense</button>
              </form>
              <ul>
                <li ng-repeat="exp in expenses">
                  {{exp.amount | currency}} - {{exp.description}}
                  <button ng-click="deleteExpense($index)">Delete</button>
                </li>
              </ul>
            </section>
          `,
          controller: "ExpensesController",
        })
        .when("/income", {
          template: `
            <section>
              <h2>Income</h2>
              <form ng-submit="addIncome()">
                <input type="number" ng-model="income.amount" placeholder="Amount" required />
                <input type="text" ng-model="income.source" placeholder="Source" required />
                <button type="submit">Add Income</button>
              </form>
              <ul>
                <li ng-repeat="inc in incomes">
                  {{inc.amount | currency}} - {{inc.source}}
                  <button ng-click="deleteIncome($index)">Delete</button>
                </li>
              </ul>
            </section>
          `,
          controller: "IncomeController",
        })
        .otherwise({
          redirectTo: "/dashboard",
        });
    });

    app.run(function ($rootScope, $location) {
      $rootScope.incomes = [];
      $rootScope.expenses = [];
      $rootScope.$on("$routeChangeSuccess", function () {
        $rootScope.currentRoute = $location.path();
      });
    });

    app.controller("DashboardController", function ($scope, $rootScope) {
      function calculateSummary() {
        const totalIncome = $rootScope.incomes.reduce((sum, income) => sum + parseFloat(income.amount), 0);
        const totalExpenses = $rootScope.expenses.reduce((sum, expense) => sum + parseFloat(expense.amount), 0);

        return {
          totalIncome: totalIncome,
          totalExpenses: totalExpenses,
          netBalance: totalIncome - totalExpenses,
        };
      }

      $scope.summary = calculateSummary();

      $rootScope.$watchGroup(["incomes", "expenses"], function () {
        $scope.summary = calculateSummary();
      });
    });

    app.controller("ExpensesController", function ($scope, $rootScope) {
      $scope.expenses = $rootScope.expenses;

      $scope.addExpense = function () {
        if ($scope.expense) {
          $scope.expenses.push({
            amount: parseFloat($scope.expense.amount),
            description: $scope.expense.description,
          });
          $scope.expense = {};
        }
      };

      $scope.deleteExpense = function (index) {
        $scope.expenses.splice(index, 1);
      };
    });

    app.controller("IncomeController", function ($scope, $rootScope) {
      $scope.incomes = $rootScope.incomes;

      $scope.addIncome = function () {
        if ($scope.income) {
          $scope.incomes.push({
            amount: parseFloat($scope.income.amount),
            source: $scope.income.source,
          });
          $scope.income = {};
        }
      };

      $scope.deleteIncome = function (index) {
        $scope.incomes.splice(index, 1);
      };
    });
  </script>
</body>
</html>
